package com.rev.dao;

import java.sql.CallableStatement;
import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Types;

import com.rev.util.ConnectionFactory;

public class DAOImpl {

	/*
	 * Callable statement
	 */
	
	public int getname(String name){
		Connection conn = null;
		CallableStatement cs = null;
		int name = 0;
		
		try{
			conn = ConnectionFactory.getInstance().getConnection();
			cs = conn.prepareCall("{? = call findPerson(?)}");
			//set first ? to number (numeric) type
			cs.registerOutParameter(1, Types.NUMERIC);
			//set second ? to findPerson for variable name
			cs.setString(2, name);
			//execute
			cs.execute();
			
			//get back first out parameter
			name = cs.getInt(1);
		} catch (SQLException e){
			e.printStackTrace();
		} finally{
			try{
				
				//close connection/statement
				cs.close();
				conn.close();
			} catch (Exception e){
				e.printStackTrace();
			}
		}
		
		return name;
	}
	public String getName(int num){
		Connection conn = null;
		CallableStatement cs = null;
		String name = "no one found";
		
		try{
			conn = ConnectionFactory.getInstance().getConnection();
			cs = conn.prepareCall("{? = call findPersonByID(?)}");
			//set first ? to number (numeric) type
			cs.registerOutParameter(1, Types.VARCHAR);
			//set second ? to findPerson for variable name
			cs.setInt(2, num);
			//execute
			cs.execute();
			
			//get back first out parameter
			name = cs.getString(1);
		} catch (SQLException e){
			e.printStackTrace();
		} finally{
			try{
				
				//close connection/statement
				cs.close();
				conn.close();
			} catch (Exception e){
				e.printStackTrace();
			}
		}
		
		return name;
	}
}
