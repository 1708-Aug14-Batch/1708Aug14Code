package com.bank.main;

import java.util.Scanner;

import com.bank.pojos.Account;
import com.bank.service.Service;

/*
 * Requirements:
 * 	User can...
 * 		- login
 * 		- create an account
 * 		- logout
 * 		- withdraw or deposit funds
 * 		- view own account balance
 * 		- edit own information
 * 
 * Tech Specs
 * 	- core java, file i/o
 */

public class RunBank {

	private static Scanner scan = new Scanner(System.in);
	private static Service bankService = new Service();
	// Keeps track of the account currently logged into the system
	private static Account accountLoggedIn = null;;

	// Implementation to actually run bank application
	public static void main(String[] args) {

		System.out.println("Hello. Welcome to the automating banking system.");

		bankingSystem();

		System.out.println("Thank you for using the automating banking system. Goodbye.");

		scan.close();

	}

	private static void bankingSystem() {

		while (true) {
			if (accountLoggedIn != null)
				displayBasicAccountInfo();
			System.out.println("Please choose one of the following commands:");
			System.out.println("login, logout, create account, withdraw, deposit, view account, edit account");

			// FIXME can case statement ignore case?
			switch(scan.nextLine()) {
			case "login":
				if (accountLoggedIn != null) {
					System.out.println("A user is already logged in.");
					continue;
				}

				login();
				
				break;
			case "logout":
				if (accountLoggedIn == null) {
					System.out.println("You must log in before you can log out.");
					continue;
				}

				logout();

				break;
			case "create account":
				
				createAccount();

				break;
			case "withdraw":
				if (accountLoggedIn == null) {
					System.out.println("You must log in before modifying your account");
					continue;
				}
				
				withdraw();

				break;
			case "deposit":
				if (accountLoggedIn == null) {
					System.out.println("You must log in before modifying your account");
					continue;
				}
				
				deposit();

				break;
			case "view account":
				if (accountLoggedIn == null) {
					System.out.println("You must log in before modifying your account");
					continue;
				}
				
				viewAccount();

				break;
			case "edit account":
				if (accountLoggedIn == null) {
					System.out.println("You must log in before modifying your account");
					continue;
				}
				
				editAccount();

				break;
			}	// end case statement
			
			// Formatting
			System.out.println();
		}

	}

	private static void displayBasicAccountInfo() {
		System.out.println("Logged in as: " + accountLoggedIn.getUsername() +
				", " + accountLoggedIn.getType());
	}

	// Returns true if login was successful
	private static void login() {
		System.out.print("Enter username: ");
		String username = scan.nextLine();
		System.out.print("Enter password: ");
		String password = scan.nextLine();
		
		Account acc = bankService.validateUser(username, password);
		
		if (acc == null) {
			System.out.println("Login failed, incorrect username and password combination.");
		} else {
			System.out.println("Login successful, welcome " + acc.getUsername());
			accountLoggedIn = acc;
		}
	}

	// Returns true if logout was successful
	private static boolean logout() {
		
		System.out.println("Logout successful.");
		accountLoggedIn = null;
		
		return true;
	}

	// Returns true if an account waas sucessfully created
	private static boolean createAccount() {
		
	}

	private static boolean withdraw() {
		
	}
	private static boolean deposit() {
		
	}
	private static boolean viewAccount() {
		
	}
	private static boolean editAccount() {
		
	}

}
