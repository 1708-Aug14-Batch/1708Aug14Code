package com.bank.service;

import java.math.BigDecimal;
import java.util.List;

import com.bank.dao.DAO;
import com.bank.dao.DAOTextFile;
import com.bank.pojos.User;

public class BankService {
	private DAO<User> dao;
	private List<User> users;
	private User curUser;
	
	public BankService(String path) {
		dao = new DAOTextFile(path);
		users = dao.read();
	}
	
	public void createNewUser(String first, String last, String email, String password) {
		User u = new User();
		u.setFirst(first);
		u.setLast(last);
		u.setEmail(email);
		u.setPassword(password);
		users.add(u);
	}
	
	public boolean login(String email, String password) {
		for (User usr: users)
			if (usr.getEmail().equals(email) && usr.getPassword().equals(password)) {
				curUser = usr;
				return true;
			}
		return false;
	}
	
	public void addFunds(String funds)  {
		curUser.deposit(new BigDecimal(funds));
	}
	
	public void withdraw(String funds)  {
		curUser.withdraw(new BigDecimal(funds));
	}
	
	public void finish() {
		dao.write(users);
	}
}
